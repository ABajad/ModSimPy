
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chapter 14 &#8212; Modeling and Simulation in Python</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 15" href="chap15.html" />
    <link rel="prev" title="Chapter 13" href="chap13.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Modeling and Simulation in Python</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Modeling and Simulation in Python
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap01.html">
   Chapter 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap02.html">
   Chapter 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap03.html">
   Chapter 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap04.html">
   Chapter 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap05.html">
   Chapter 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap06.html">
   Chapter 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap07.html">
   Chapter 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap08.html">
   Chapter 8
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap09.html">
   Chapter 9
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap10.html">
   Chapter 10
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap11.html">
   Chapter 11
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap12.html">
   Chapter 12
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap13.html">
   Chapter 13
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 14
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap15.html">
   Chapter 15
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap16.html">
   Chapter 16
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap17.html">
   Chapter 17
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap18.html">
   Chapter 18
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap19.html">
   Chapter 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap20.html">
   Chapter 20
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap21.html">
   Chapter 21
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap22.html">
   Chapter 22
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap23.html">
   Chapter 23
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap24.html">
   Chapter 24
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap25.html">
   Chapter 25
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap26.html">
   Chapter 26
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chap14.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/AllenDowney/ModSimPy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/AllenDowney/ModSimPy/master?urlpath=tree/chap14.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nondimensionalization">
   Nondimensionalization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-the-results">
   Exploring the results
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#contact-number">
   Contact number
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysis-and-simulation">
   Analysis and simulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-contact-number">
   Estimating contact number
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="chapter-14">
<h1>Chapter 14<a class="headerlink" href="#chapter-14" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ModSimPy/blob/master//chapters/chap14.ipynb">Click here to run this chapter on Colab</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import code from previous notebooks</span>

<span class="kn">from</span> <span class="nn">chap11</span> <span class="kn">import</span> <span class="n">make_system</span>
<span class="kn">from</span> <span class="nn">chap11</span> <span class="kn">import</span> <span class="n">update_func</span>
<span class="kn">from</span> <span class="nn">chap11</span> <span class="kn">import</span> <span class="n">run_simulation</span>

<span class="kn">from</span> <span class="nn">chap12</span> <span class="kn">import</span> <span class="n">calc_total_infected</span>

<span class="kn">from</span> <span class="nn">chap13</span> <span class="kn">import</span> <span class="n">sweep_beta</span>
<span class="kn">from</span> <span class="nn">chap13</span> <span class="kn">import</span> <span class="n">sweep_parameters</span>
</pre></div>
</div>
</div>
</div>
<p>In the previous chapters we used simulation to predict the effect of an infectious disease in a susceptible population and to design
interventions that would minimize the effect.</p>
<p>In this chapter we use analysis to investigate the relationship between the parameters, <code class="docutils literal notranslate"><span class="pre">beta</span></code> and <code class="docutils literal notranslate"><span class="pre">gamma</span></code>, and the outcome of the simulation.</p>
<div class="section" id="nondimensionalization">
<h2>Nondimensionalization<a class="headerlink" href="#nondimensionalization" title="Permalink to this headline">¶</a></h2>
<p>The figures in
Section <a class="reference external" href="#sweepframe">[sweepframe]</a>{reference-type=”ref”
reference=”sweepframe”} suggest that there is a relationship between the parameters of the SIR model, <code class="docutils literal notranslate"><span class="pre">beta</span></code> and <code class="docutils literal notranslate"><span class="pre">gamma</span></code>, that determines the outcome of the simulation, the fraction of students infected. Let’s think what that relationship might be.</p>
<ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">beta</span></code> exceeds <code class="docutils literal notranslate"><span class="pre">gamma</span></code>, that means there are more contacts
(that is, potential infections) than recoveries during each day (or other unit of time). The difference between <code class="docutils literal notranslate"><span class="pre">beta</span></code> and <code class="docutils literal notranslate"><span class="pre">gamma</span></code> might be called the “excess contact rate”, in units of contacts per day.</p></li>
<li><p>As an alternative, we might consider the ratio <code class="docutils literal notranslate"><span class="pre">beta/gamma</span></code>, which
is the number of contacts per recovery. Because the numerator and
denominator are in the same units, this ratio is <strong>dimensionless</strong>, which means it has no units.</p></li>
</ul>
<p>Describing physical systems using dimensionless parameters is often a
useful move in the modeling and simulation game. It is so useful, in
fact, that it has a name: <strong>nondimensionalization</strong> (see
<a class="reference external" href="http://modsimpy.com/nondim">http://modsimpy.com/nondim</a>).</p>
<p>So we’ll try the second option first.</p>
</div>
<div class="section" id="exploring-the-results">
<h2>Exploring the results<a class="headerlink" href="#exploring-the-results" title="Permalink to this headline">¶</a></h2>
<p>Suppose we have a <code class="docutils literal notranslate"><span class="pre">SweepFrame</span></code> with one row for each value of <code class="docutils literal notranslate"><span class="pre">beta</span></code> and one column for each value of <code class="docutils literal notranslate"><span class="pre">gamma</span></code>. Each element in the <code class="docutils literal notranslate"><span class="pre">SweepFrame</span></code> is the fraction of students infected in a simulation with a given pair of parameters.</p>
<p>We can print the values in the <code class="docutils literal notranslate"><span class="pre">SweepFrame</span></code> like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beta_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="n">gamma_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">sweep_parameters</span><span class="p">(</span><span class="n">beta_array</span><span class="p">,</span> <span class="n">gamma_array</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0.2</th>
      <th>0.4</th>
      <th>0.6</th>
      <th>0.8</th>
    </tr>
    <tr>
      <th>Parameter</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.1</th>
      <td>0.010756</td>
      <td>0.003642</td>
      <td>0.002191</td>
      <td>0.001567</td>
    </tr>
    <tr>
      <th>0.2</th>
      <td>0.118984</td>
      <td>0.010763</td>
      <td>0.005447</td>
      <td>0.003644</td>
    </tr>
    <tr>
      <th>0.3</th>
      <td>0.589095</td>
      <td>0.030185</td>
      <td>0.010771</td>
      <td>0.006526</td>
    </tr>
    <tr>
      <th>0.4</th>
      <td>0.801339</td>
      <td>0.131563</td>
      <td>0.020917</td>
      <td>0.010780</td>
    </tr>
    <tr>
      <th>0.5</th>
      <td>0.896577</td>
      <td>0.396409</td>
      <td>0.046140</td>
      <td>0.017640</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="n">gamma</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">column</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">frac_infected</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="n">beta</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">frac_infected</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1 0.2 0.010756340768063644
0.2 0.2 0.11898421353185373
0.3 0.2 0.5890954199973404
0.4 0.2 0.8013385277185551
0.5 0.2 0.8965769637207062
0.6 0.2 0.942929291399791
0.7 0.2 0.966299311298026
0.8 0.2 0.9781518959989762
0.9 0.2 0.9840568957948106
1.0 0.2 0.9868823507202488
1.1 0.2 0.988148177093735
0.1 0.4 0.0036416926514175607
0.2 0.4 0.010763463373360094
0.3 0.4 0.030184952469116566
0.4 0.4 0.131562924303259
0.5 0.4 0.3964094037932606
0.6 0.4 0.5979016626615987
0.7 0.4 0.7284704154876106
0.8 0.4 0.8144604459153759
0.9 0.4 0.8722697237137128
1.0 0.4 0.9116692168795855
1.1 0.4 0.9386802509510287
0.1 0.6 0.002190722188881611
0.2 0.6 0.005446688837466351
0.3 0.6 0.010771139974975585
0.4 0.6 0.020916599304195316
0.5 0.6 0.04614035896610047
0.6 0.6 0.13288938996079536
0.7 0.6 0.3118432512847451
0.8 0.6 0.47832565854255393
0.9 0.6 0.605687582114665
1.0 0.6 0.7014254793376209
1.1 0.6 0.7738176405451065
0.1 0.8 0.0015665254038139675
0.2 0.8 0.003643953969662994
0.3 0.8 0.006526163529085194
0.4 0.8 0.010779807499500693
0.5 0.8 0.017639902596349066
0.6 0.8 0.030291868201986594
0.7 0.8 0.05882382948158804
0.8 0.8 0.13358889291095588
0.9 0.8 0.2668895539427739
1.0 0.8 0.40375121210421994
1.1 0.8 0.519583469821867
</pre></div>
</div>
</div>
</div>
<p>This is the first example we’ve seen with one <code class="docutils literal notranslate"><span class="pre">for</span></code> loop inside another:</p>
<ul class="simple">
<li><p>Each time the outer loop runs, it selects a value of <code class="docutils literal notranslate"><span class="pre">gamma</span></code> from
the columns of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and extracts the corresponding
column.</p></li>
<li><p>Each time the inner loop runs, it selects a value of <code class="docutils literal notranslate"><span class="pre">beta</span></code> from the
column and selects the corresponding element, which is the fraction
of students infected.</p></li>
</ul>
<p>In the example from the previous chapter, <code class="docutils literal notranslate"><span class="pre">frame</span></code> has 4 columns, one for
each value of <code class="docutils literal notranslate"><span class="pre">gamma</span></code>, and 11 rows, one for each value of <code class="docutils literal notranslate"><span class="pre">beta</span></code>. So
these loops print 44 lines, one for each pair of parameters.</p>
<p>The following function encapulates the previous loop and plots the
fraction infected as a function of the ratio <code class="docutils literal notranslate"><span class="pre">beta/gamma</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">plot</span>

<span class="k">def</span> <span class="nf">plot_sweep_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">series</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="n">gamma</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">frac_infected</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="n">beta</span><span class="p">]</span>
            <span class="n">plot</span><span class="p">(</span><span class="n">beta</span><span class="o">/</span><span class="n">gamma</span><span class="p">,</span> <span class="n">frac_infected</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> 
                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sweep_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Contact number (beta/gamma)&#39;</span><span class="p">,</span>
         <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Fraction infected&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap14_14_0.png" src="_images/chap14_14_0.png" />
</div>
</div>
<p>The results fall on a single curve, at least approximately. That means that we can predict the fraction of students who will be infected based on a single parameter, the ratio <code class="docutils literal notranslate"><span class="pre">beta/gamma</span></code>. We don’t need to know the values of <code class="docutils literal notranslate"><span class="pre">beta</span></code> and <code class="docutils literal notranslate"><span class="pre">gamma</span></code> separately.</p>
</div>
<div class="section" id="contact-number">
<h2>Contact number<a class="headerlink" href="#contact-number" title="Permalink to this headline">¶</a></h2>
<p>From Section xxx, recall that the number of new infections in a
given day is <span class="math notranslate nohighlight">\(\beta s i N\)</span>, and the number of recoveries is
<span class="math notranslate nohighlight">\(\gamma i N\)</span>. If we divide these quantities, the result is
<span class="math notranslate nohighlight">\(\beta s / \gamma\)</span>, which is the number of new infections per recovery
(as a fraction of the population).</p>
<p>When a new disease is introduced to a susceptible population, <span class="math notranslate nohighlight">\(s\)</span> is
approximately 1, so the number of people infected by each sick person is <span class="math notranslate nohighlight">\(\beta / \gamma\)</span>. This ratio is called the “contact number” or “basic reproduction number” (see <a class="reference external" href="http://modsimpy.com/contact">http://modsimpy.com/contact</a>). By convention it is usually denoted <span class="math notranslate nohighlight">\(R_0\)</span>, but in the context of an SIR model, this notation is confusing, so we’ll use <span class="math notranslate nohighlight">\(c\)</span> instead.</p>
<p>The results in the previous section suggest that there is a relationship between <span class="math notranslate nohighlight">\(c\)</span> and the total number of infections. We can derive this relationship by analyzing the differential equations from
Section xxx:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\frac{ds}{dt} &amp;= -\beta s i \\
\frac{di}{dt} &amp;= \beta s i - \gamma i\\
\frac{dr}{dt} &amp;= \gamma i\end{aligned}\end{split}\]</div>
<p>In the same way we divided the
contact rate by the infection rate to get the dimensionless quantity
<span class="math notranslate nohighlight">\(c\)</span>, now we’ll divide <span class="math notranslate nohighlight">\(di/dt\)</span> by <span class="math notranslate nohighlight">\(ds/dt\)</span> to get a ratio of rates:</p>
<div class="math notranslate nohighlight">
\[\frac{di}{ds} = -1 + \frac{1}{cs}\]</div>
<p>Dividing one differential equation by another is not an obvious move, but in this case it is useful because it gives us a relationship between <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(s\)</span> and <span class="math notranslate nohighlight">\(c\)</span> that does not depend on time. From that relationship, we can derive an equation that relates <span class="math notranslate nohighlight">\(c\)</span> to the final value of <span class="math notranslate nohighlight">\(s\)</span>. In theory, this equation makes it possible to infer <span class="math notranslate nohighlight">\(c\)</span> by observing the course of an epidemic.</p>
<p>Here’s how the derivation goes. We multiply both sides of the previous
equation by <span class="math notranslate nohighlight">\(ds\)</span>:</p>
<div class="math notranslate nohighlight">
\[di = \left( -1 + \frac{1}{cs} \right) ds\]</div>
<p>And then integrate both sides:</p>
<div class="math notranslate nohighlight">
\[i = -s + \frac{1}{c} \log s + q\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> is a constant of integration. Rearranging terms yields:</p>
<div class="math notranslate nohighlight">
\[q = i + s - \frac{1}{c} \log s\]</div>
<p>Now let’s see if we can figure out what <span class="math notranslate nohighlight">\(q\)</span> is. At the beginning of an epidemic, if the fraction infected is small and nearly everyone is susceptible, we can use the approximations <span class="math notranslate nohighlight">\(i(0) = 0\)</span> and <span class="math notranslate nohighlight">\(s(0) = 1\)</span> to compute <span class="math notranslate nohighlight">\(q\)</span>:</p>
<div class="math notranslate nohighlight">
\[q = 0 + 1 + \frac{1}{c} \log 1\]</div>
<p>Since <span class="math notranslate nohighlight">\(\log 1 = 0\)</span>, we get <span class="math notranslate nohighlight">\(q = 1\)</span>.</p>
<p>Now, at the end of the epidemic, let’s assume that <span class="math notranslate nohighlight">\(i(\infty) = 0\)</span>, and <span class="math notranslate nohighlight">\(s(\infty)\)</span> is an unknown quantity, <span class="math notranslate nohighlight">\(s_{\infty}\)</span>. Now we have:</p>
<div class="math notranslate nohighlight">
\[q = 1 = 0 + s_{\infty}- \frac{1}{c} \log s_{\infty}\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(c\)</span>, we get $<span class="math notranslate nohighlight">\(c = \frac{\log s_{\infty}}{s_{\infty}- 1}\)</span><span class="math notranslate nohighlight">\( By relating \)</span>c<span class="math notranslate nohighlight">\( and \)</span>s_{\infty}<span class="math notranslate nohighlight">\(, this equation makes it possible to estimate \)</span>c$ based on data, and possibly predict the behavior of future epidemics.</p>
</div>
<div class="section" id="analysis-and-simulation">
<h2>Analysis and simulation<a class="headerlink" href="#analysis-and-simulation" title="Permalink to this headline">¶</a></h2>
<p>Let’s compare this analytic result to the results from simulation. I’ll create an array of values for <span class="math notranslate nohighlight">\(s_{\infty}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linspace</span>

<span class="n">s_inf_array</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And compute the corresponding values of <span class="math notranslate nohighlight">\(c\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">log</span>

<span class="n">c_array</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">s_inf_array</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">s_inf_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To get the total infected, we compute the difference between <span class="math notranslate nohighlight">\(s(0)\)</span> and
<span class="math notranslate nohighlight">\(s(\infty)\)</span>, then store the results in a <code class="docutils literal notranslate"><span class="pre">Series</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frac_infected</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">s_inf_array</span>
</pre></div>
</div>
</div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">make_series</span></code> to put <code class="docutils literal notranslate"><span class="pre">c_array</span></code>
and <code class="docutils literal notranslate"><span class="pre">frac_infected</span></code> in a Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frac_infected_series</span> <span class="o">=</span> <span class="n">make_series</span><span class="p">(</span><span class="n">c_array</span><span class="p">,</span> <span class="n">frac_infected</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can plot the results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sweep_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="n">frac_infected_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analysis&#39;</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Contact number (c)&#39;</span><span class="p">,</span>
         <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Fraction infected&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap14_29_0.png" src="_images/chap14_29_0.png" />
</div>
</div>
<p>When the contact number exceeds 1, analysis and simulation agree. When
the contact number is less than 1, they do not: analysis indicates there should be no infections; in the simulations there are a small number of infections.</p>
<p>The reason for the discrepancy is that the simulation divides time into a discrete series of days, whereas the analysis treats time as a
continuous quantity. In other words, the two methods are actually based on different models. So which model is better?</p>
<p>Probably neither. When the contact number is small, the early progress
of the epidemic depends on details of the scenario. If we are lucky, the original infected person, “patient zero”, infects no one and there is no epidemic. If we are unlucky, patient zero might have a large number of close friends, or might work in the dining hall (and fail to observe safe food handling procedures).</p>
<p>For contact numbers near or less than 1, we might need a more detailed
model. But for higher contact numbers the SIR model might be good
enough.</p>
</div>
<div class="section" id="estimating-contact-number">
<h2>Estimating contact number<a class="headerlink" href="#estimating-contact-number" title="Permalink to this headline">¶</a></h2>
<p>Figure xxx shows that if we know the contact number, we can compute the fraction infected. But we can also read the figure the other way; that is, at the end of an epidemic, if we can estimate the fraction of the population that was ever infected, we can use it to estimate the contact number.</p>
<p>Well, in theory we can. In practice, it might not work very well,
because of the shape of the curve. When the contact number is near 2,
the curve is quite steep, which means that small changes in <span class="math notranslate nohighlight">\(c\)</span> yield
big changes in the number of infections. If we observe that the total
fraction infected is anywhere from 20% to 80%, we would conclude that
<span class="math notranslate nohighlight">\(c\)</span> is near 2.</p>
<p>On the other hand, for larger contact numbers, nearly the entire
population is infected, so the curve is nearly flat. In that case we
would not be able to estimate <span class="math notranslate nohighlight">\(c\)</span> precisely, because any value greater
than 3 would yield effectively the same results. Fortunately, this is
unlikely to happen in the real world; very few epidemics affect anything close to 90% of the population.</p>
<p>So the SIR model has limitations; nevertheless, it provides insight into the behavior of infectious disease, especially the phenomenon of herd immunity. As we saw in Chapter xxx, if we know the parameters of the model, we can use it to evaluate possible interventions. And as we saw in this chapter, we might be able to use data from earlier outbreaks to estimate the parameters.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise:</strong>  If we didn’t know about contact numbers, we might have explored other possibilities, like the difference between <code class="docutils literal notranslate"><span class="pre">beta</span></code> and <code class="docutils literal notranslate"><span class="pre">gamma</span></code>, rather than their ratio.</p>
<p>Write a version of <code class="docutils literal notranslate"><span class="pre">plot_sweep_frame</span></code>, called <code class="docutils literal notranslate"><span class="pre">plot_sweep_frame_difference</span></code>, that plots the fraction infected versus the difference <code class="docutils literal notranslate"><span class="pre">beta-gamma</span></code>.</p>
<p>What do the results look like, and what does that imply?</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="k">def</span> <span class="nf">plot_sweep_frame_difference</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="n">gamma</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">column</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">frac_infected</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="n">beta</span><span class="p">]</span>
            <span class="n">plot</span><span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">frac_infected</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> 
                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">plot_sweep_frame_difference</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Excess infection rate (infections-recoveries per day)&#39;</span><span class="p">,</span>
         <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Fraction infected&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap14_35_0.png" src="_images/chap14_35_0.png" />
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># The results don&#39;t fall on a line, which means that if we </span>
<span class="c1"># know the difference between `beta` and `gamma`, </span>
<span class="c1"># but not their ratio, that&#39;s not enough to predict </span>
<span class="c1"># the fraction infected.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise:</strong> Suppose you run a survey at the end of the semester and find that 26% of students had the Freshman Plague at some point.</p>
<p>What is your best estimate of <code class="docutils literal notranslate"><span class="pre">c</span></code>?</p>
<p>Hint: if you print <code class="docutils literal notranslate"><span class="pre">frac_infected_series</span></code>, you can read off the answer.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="n">frac_infected_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.211261    0.999900
3.516747    0.966603
2.901137    0.933307
2.558511    0.900010
2.325167    0.866713
2.150496    0.833417
2.012246    0.800120
1.898689    0.766823
1.802908    0.733527
1.720492    0.700230
1.648460    0.666933
1.584709    0.633637
1.527703    0.600340
1.476285    0.567043
1.429566    0.533747
1.386847    0.500450
1.347569    0.467153
1.311281    0.433857
1.277610    0.400560
1.246247    0.367263
1.216935    0.333967
1.189452    0.300670
1.163613    0.267373
1.139256    0.234077
1.116242    0.200780
1.094449    0.167483
1.073772    0.134187
1.054117    0.100890
1.035401    0.067593
1.017551    0.034297
1.000500    0.001000
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># It looks like the fraction infected is 0.26 when the contact </span>
<span class="c1"># number is about 1.16</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="chap13.html" title="previous page">Chapter 13</a>
    <a class='right-next' id="next-link" href="chap15.html" title="next page">Chapter 15</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Allen B. Downey<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>